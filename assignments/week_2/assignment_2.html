<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>assignment_2.md - Grip</title>
  <link rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEACABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAKCgr/FRUX/xYWGP8YGBr/GRkb/xsbHP8dHR7/Hh4f/x4eIP8fHyD/ICAh/yMjJP8kJCX/JiYo/ygoKv8pKSr/LCwu/y0tLv80NDT/QUFC/0ZGR/9MTE7/UFBR/1JSUv9bW1v/XFxc/2BgYP9hYWP/aGhp/2xsbP9ycnL/d3d3/3l5e/98fHz/f3+A/2dn/P9z3a//cNX8/4CAgP+Xl5f/nZ2e/56en/+fn5//n5+h/6amp/+rq6v/rKys/7CvsP+zs7T/uLi5/7u7u/+8vLz/wMDA/8fHx//Kysr/zc3N/9HR0f/d3d3/3t7e/+Xl5f/q6ur/6+vr/+3t7f/z8/P/9fX1//b29v/39/f/+Pj4//n5+f/6+vr/+/v7//z8/P/9/f3//v7+//////8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/NCYmJiYmJiYmJiYmJiYmNCZKSkpKSkpKSkpKSkpKSiYmSkpKRisdRkMbMklKSkomJkpKSSEiNUhEEQwpSUpKJiZKSi8LHhhAPAwBDDZKSiYmSkoWACA7SEc6HAEaSkomJkpKBxI/SkpKSj4ICkpKJiZKSgUTR0pKSkpGDwZKSiYmSkoTED1KSkpKOQQVSkomJkpKKgowMy4sNycIMUpKJiZKSkEZDgkDAgsNH0VKSiYmSkpKQigUBgkXLUhKSkomJkpKSkpKSkpKSkpKSkpKJiYmJiYmJiYmJiYmJiYmJiYmIyUkNDQ0NDQ0NDQ0NDQmOCYmJiYmJiYmJiYmJiYmOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=" />
  <link rel="stylesheet" href="//octicons.github.com/components/octicons/octicons/octicons.css" />
  <style>
    /* Page tweaks */
    .preview-page {
      margin-top: 64px;
    }
    /* User-content tweaks */
    .timeline-comment-wrapper > .timeline-comment:after,
    .timeline-comment-wrapper > .timeline-comment:before {
      content: none;
    }
    /* User-content overrides */
    .discussion-timeline.wide {
      width: 920px;
    }
  </style>
</head>
<body>
  <div class="page">
    <div id="preview-page" class="preview-page" data-autorefresh-url="">

    

      <div role="main" class="main-content">
        <div class="container new-discussion-timeline experiment-repo-nav">
          <div class="repository-content">
            <div id="readme" class="readme boxed-group clearfix announce instapaper_body md">
              
                <h3>
                  <span class="octicon octicon-book"></span>
                  assignment_2.md - Grip
                </h3>
              
              <article class="markdown-body entry-content" itemprop="text" id="grip-content">
                <h1>
<a id="user-content-assignment-2" class="anchor" href="#assignment-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Assignment 2</h1>
<p>Suggested due date: 24th October 2018</p>
<h2>
<a id="user-content-multilayer-perceptron--feedforward-network" class="anchor" href="#multilayer-perceptron--feedforward-network" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Multilayer perceptron / Feedforward network</h2>
<p>The aims for this assignment are:</p>
<ul>
<li>Implement a simple MLP classifier in Tensorflow</li>
<li>Train a neural network using backpropagation</li>
</ul>
<p>We will build a multilayer perceptron as a classifier, and train it using backpropagation. The MLP consists of several densely connected layers</p>
<h2>
<a id="user-content-mnist-mlp-classifier" class="anchor" href="#mnist-mlp-classifier" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>MNIST MLP classifier</h2>
<p align="center">
  <a href="mnist.png" target="_blank" rel="noopener noreferrer"><img width="460" height="300" src="mnist.png" style="max-width:100%;"></a>
</p>
<p>For this assignment you will need to download the MNIST dataset, which is available here. This dataset consists of 28x28 grayscale images, with associated labels for which digit the image contains (0-9). The training set consists of 60,000 examples and the test set is 10,000 examples.</p>
<p>The MLP is a densely connected network, with <a href="https://www.codecogs.com/eqnedit.php?latex=%24N%24" rel="nofollow"><img src="https://camo.githubusercontent.com/b46a578ea895ab11b986d488f40b73055ebc3a31/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f244e24" title="$N$" data-canonical-src="https://latex.codecogs.com/gif.latex?$N$" style="max-width:100%;"></a> layers <a href="https://www.codecogs.com/eqnedit.php?latex=%24h_1,%5Cldots,h_N%24" rel="nofollow"><img src="https://camo.githubusercontent.com/ea77a2538d9e1cd6bd3bb9d6c503d38029f97bc5/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f24685f312c5c6c646f74732c685f4e24" title="$h_1,\ldots,h_N$" data-canonical-src="https://latex.codecogs.com/gif.latex?$h_1,\ldots,h_N$" style="max-width:100%;"></a>, where <a href="https://www.codecogs.com/eqnedit.php?latex=%24h_i%5Cin%5Cmathbb%7BR%7D%5E%7Bn_i%7D%24" rel="nofollow"><img src="https://camo.githubusercontent.com/530ffc05a354447088526560ff6437b1c32acd58/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f24685f695c696e5c6d61746862627b527d5e7b6e5f697d24" title="$h_i\in\mathbb{R}^{n_i}$" data-canonical-src="https://latex.codecogs.com/gif.latex?$h_i\in\mathbb{R}^{n_i}$" style="max-width:100%;"></a>. The input <a href="https://www.codecogs.com/eqnedit.php?latex=%24%5Cmathbf%7Bx%7D&amp;space;=&amp;space;h_1%24" rel="nofollow"><img src="https://camo.githubusercontent.com/206bdc5ea0376d99fc63216178c21ba367c4fa11/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f245c6d61746862667b787d2673706163653b3d2673706163653b685f3124" title="$\mathbf{x} = h_1$" data-canonical-src="https://latex.codecogs.com/gif.latex?$\mathbf{x}&amp;space;=&amp;space;h_1$" style="max-width:100%;"></a> and output <a href="https://www.codecogs.com/eqnedit.php?latex=%24%5Cmathbf%7By%7D&amp;space;=&amp;space;h_N%24" rel="nofollow"><img src="https://camo.githubusercontent.com/c41c7ab575c323656ab537212388f59e4eeab905/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f245c6d61746862667b797d2673706163653b3d2673706163653b685f4e24" title="$\mathbf{y} = h_N$" data-canonical-src="https://latex.codecogs.com/gif.latex?$\mathbf{y}&amp;space;=&amp;space;h_N$" style="max-width:100%;"></a>. For <a href="https://www.codecogs.com/eqnedit.php?latex=%24i=1,%5Cldots,N-1%24" rel="nofollow"><img src="https://camo.githubusercontent.com/2c680c2df8c1e04e7bc58cd7a2f2fab4f090105b/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f24693d312c5c6c646f74732c4e2d3124" title="$i=1,\ldots,N-1$" data-canonical-src="https://latex.codecogs.com/gif.latex?$i=1,\ldots,N-1$" style="max-width:100%;"></a>, the pre-activations are given by</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=%5Chat%7Bh%7D_%7Bi&amp;plus;1%7D&amp;space;=&amp;space;W%5E%7B(i)%7Dh_i&amp;space;&amp;plus;&amp;space;b%5E%7B(i)%7D" rel="nofollow"><img src="https://camo.githubusercontent.com/0498f3dcdf12719164f784297d9f895c854fb410/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f5c6861747b687d5f7b6926706c75733b317d2673706163653b3d2673706163653b575e7b2869297d685f692673706163653b26706c75733b2673706163653b625e7b2869297d" title="\hat{h}_{i+1} = W^{(i)}h_i + b^{(i)}" data-canonical-src="https://latex.codecogs.com/gif.latex?\hat{h}_{i&amp;plus;1}&amp;space;=&amp;space;W^{(i)}h_i&amp;space;&amp;plus;&amp;space;b^{(i)}" style="max-width:100%;"></a>,</p>
<p>where <a href="https://www.codecogs.com/eqnedit.php?latex=%24W%5E%7B(i)%7D%5Cin%5Cmathbb%7BR%7D%5E%7Bn_%7Bi&amp;plus;1%7D%5Ctimes&amp;space;n_i%7D%24" rel="nofollow"><img src="https://camo.githubusercontent.com/a4f308bb043555c0baf5190e3829b4f1fc59edd4/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f24575e7b2869297d5c696e5c6d61746862627b527d5e7b6e5f7b6926706c75733b317d5c74696d65732673706163653b6e5f697d24" title="$W^{(i)}\in\mathbb{R}^{n_{i+1}\times n_i}$" data-canonical-src="https://latex.codecogs.com/gif.latex?$W^{(i)}\in\mathbb{R}^{n_{i&amp;plus;1}\times&amp;space;n_i}$" style="max-width:100%;"></a> and <a href="https://www.codecogs.com/eqnedit.php?latex=%24b%5E%7B(i)%7D&amp;space;%5Cin%5Cmathbb%7BR%7D%5E%7Bn_%7Bi&amp;plus;1%7D%7D%24" rel="nofollow"><img src="https://camo.githubusercontent.com/7f88cab5321e113ed04bb526a08a185db2c3a937/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f24625e7b2869297d2673706163653b5c696e5c6d61746862627b527d5e7b6e5f7b6926706c75733b317d7d24" title="$b^{(i)} \in\mathbb{R}^{n_{i+1}}$" data-canonical-src="https://latex.codecogs.com/gif.latex?$b^{(i)}&amp;space;\in\mathbb{R}^{n_{i&amp;plus;1}}$" style="max-width:100%;"></a>. The post-activations are given by</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=h_%7Bi&amp;plus;1%7D&amp;space;=&amp;space;%5Csigma&amp;space;(%5Chat%7Bh%7D_%7Bi&amp;plus;1%7D)" rel="nofollow"><img src="https://camo.githubusercontent.com/c2fdeaf4a2488d14bae395d19cc2087027b1566f/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f685f7b6926706c75733b317d2673706163653b3d2673706163653b5c7369676d612673706163653b285c6861747b687d5f7b6926706c75733b317d29" title="h_{i+1} = \sigma (\hat{h}_{i+1})" data-canonical-src="https://latex.codecogs.com/gif.latex?h_{i&amp;plus;1}&amp;space;=&amp;space;\sigma&amp;space;(\hat{h}_{i&amp;plus;1})" style="max-width:100%;"></a>,</p>
<p>where <a href="https://www.codecogs.com/eqnedit.php?latex=%24%5Csigma:%5Cmathbb%7BR%7D%5Crightarrow%5Cmathbb%7BR%7D%24" rel="nofollow"><img src="https://camo.githubusercontent.com/c8c0a8b684ca718570f2eaa68cefbae88fbc92ad/68747470733a2f2f6c617465782e636f6465636f67732e636f6d2f6769662e6c617465783f245c7369676d613a5c6d61746862627b527d5c72696768746172726f775c6d61746862627b527d24" title="$\sigma:\mathbb{R}\rightarrow\mathbb{R}$" data-canonical-src="https://latex.codecogs.com/gif.latex?$\sigma:\mathbb{R}\rightarrow\mathbb{R}$" style="max-width:100%;"></a> is an activation function that is applied element-wise.</p>
<p>For our classifier, we will flatten the inputs so it is a 784-length vector, and this will serve as input to the first hidden layer. You may also want to rescale the inputs. The output should be a 10-way softmax layer to predict the digit label.</p>
<h2>
<a id="user-content-implementation-in-tensorflow" class="anchor" href="#implementation-in-tensorflow" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Implementation in Tensorflow</h2>
<p>The assignment is to implement the MLP classifier for MNIST in Tensorflow, train it with one of the available optimisers and test the classification performance on the test set. Write your solution as a python script.</p>
<p>You should choose the number of layers for the network, the size of those layers and the activation functions (try testing a few options for these hyperparameters).</p>
<ul>
<li>Use the <code>tf.layers.dense</code> function for the hidden layers in the network</li>
<li>We recommend to use the <code>tf.nn.sparse_softmax_cross_entropy_with_logits_v2</code> to compute the loss</li>
<li>Read the TF docs carefully: the above loss function requires logits as inputs. Therefore if using this, the network output should be a linear layer</li>
<li>Create a train op in Tensorflow and train the network according to the schedule/criteria of your choice</li>
<li>Record and document the learning curves (train &amp; test loss vs training iterations or epochs), and report the final train and test loss</li>
<li>Calculate the number of parameters used in the network, and record the time required to train the network</li>
</ul>

              </article>
            </div>
          </div>
        </div>
      </div>

    

  </div>
  <div>&nbsp;</div>
  </div><script>
    function showCanonicalImages() {
      var images = document.getElementsByTagName('img');
      if (!images) {
        return;
      }
      for (var index = 0; index < images.length; index++) {
        var image = images[index];
        if (image.getAttribute('data-canonical-src') && image.src !== image.getAttribute('data-canonical-src')) {
          image.src = image.getAttribute('data-canonical-src');
        }
      }
    }

    function scrollToHash() {
      if (location.hash && !document.querySelector(':target')) {
        var element = document.getElementById('user-content-' + location.hash.slice(1));
        if (element) {
           element.scrollIntoView();
        }
      }
    }

    function autorefreshContent(eventSourceUrl) {
      var initialTitle = document.title;
      var contentElement = document.getElementById('grip-content');
      var source = new EventSource(eventSourceUrl);
      var isRendering = false;

      source.onmessage = function(ev) {
        var msg = JSON.parse(ev.data);
        if (msg.updating) {
          isRendering = true;
          document.title = '(Rendering) ' + document.title;
        } else {
          isRendering = false;
          document.title = initialTitle;
          contentElement.innerHTML = msg.content;
          showCanonicalImages();
        }
      }

      source.onerror = function(e) {
        if (e.readyState === EventSource.CLOSED && isRendering) {
          isRendering = false;
          document.title = initialTitle;
        }
      }
    }

    window.onhashchange = function() {
      scrollToHash();
    }

    window.onload = function() {
      scrollToHash();
    }

    showCanonicalImages();

    var autorefreshUrl = document.getElementById('preview-page').getAttribute('data-autorefresh-url');
    if (autorefreshUrl) {
      autorefreshContent(autorefreshUrl);
    }
  </script>
</body>
</html>